<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply Geographically Weighted Regression (GWR) — applyGWR • spEnviroDistr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply Geographically Weighted Regression (GWR) — applyGWR"><meta name="description" content="This function applies Geographically Weighted Regression (GWR) to a given formula and dataset.
GWR is a local form of linear regression used to model spatially varying relationships."><meta property="og:description" content="This function applies Geographically Weighted Regression (GWR) to a given formula and dataset.
GWR is a local form of linear regression used to model spatially varying relationships."><meta property="og:image" content="https://djwillichile.github.io/spEnviroDistr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spEnviroDistr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/djwillichile/spEnviroDistr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Apply Geographically Weighted Regression (GWR)</h1>
      <small class="dont-index">Source: <a href="https://github.com/djwillichile/spEnviroDistr/blob/master/R/applyGWR.R" class="external-link"><code>R/applyGWR.R</code></a></small>
      <div class="d-none name"><code>applyGWR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function applies Geographically Weighted Regression (GWR) to a given formula and dataset.
GWR is a local form of linear regression used to model spatially varying relationships.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">applyGWR</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  longlat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fit.points <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  showProgressSteps <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula object describing the model to be fitted, e.g., <code>log(y) ~ x1 + x2</code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A spatial data frame (<code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code>)
containing the variables in the formula.</p></dd>


<dt id="arg-longlat">longlat<a class="anchor" aria-label="anchor" href="#arg-longlat"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, coordinates are treated as longitude/latitude. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-cl">cl<a class="anchor" aria-label="anchor" href="#arg-cl"></a></dt>
<dd><p>Optional. A cluster object for parallel processing created by <code>makeCluster</code>. Default is <code>NULL</code>.</p></dd>


<dt id="arg-fit-points">fit.points<a class="anchor" aria-label="anchor" href="#arg-fit-points"></a></dt>
<dd><p>Optional. A spatial data frame for making predictions at specified locations.
If <code>NULL</code>, no predictions are made.</p></dd>


<dt id="arg-showprogresssteps">showProgressSteps<a class="anchor" aria-label="anchor" href="#arg-showprogresssteps"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, prints progress messages during the analysis. Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following components:</p><dl><dt>inputs</dt>
<dd><p>A list containing the inputs used for the GWR analysis: <code>formula</code>, <code>data</code>, and <code>longlat</code>.</p></dd>

<dt>output</dt>
<dd><p>A list of class <code>gwr</code> containing the following elements:</p></dd>









</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is intended for use with spatial datasets where relationships between variables
may vary across space. GWR fits a separate regression model at each location in the data, weighting
nearby points more heavily based on a specified bandwidth.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fotheringham, A. S., Brunsdon, C., &amp; Charlton, M. (2002). <em>Geographically Weighted Regression: The Analysis of Spatially Varying Relationships</em>. John Wiley &amp; Sons. <a href="https://doi.org/10.1002/9780470999141" class="external-link">doi:10.1002/9780470999141</a></p>
<p>Brunsdon, C., Fotheringham, A. S., &amp; Charlton, M. E. (1996). Geographically Weighted Regression: A Method for Exploring Spatial Nonstationarity. <em>Geographical Analysis</em>, 28(4), 281-298. <a href="https://doi.org/10.1111/j.1538-4632.1996.tb00936.x" class="external-link">doi:10.1111/j.1538-4632.1996.tb00936.x</a></p>
<p>Fotheringham, A. S., &amp; O'Sullivan, D. (2004). Spatial Nonstationarity and Local Models. In <em>Geographic Information Systems: Principles, Techniques, Management and Applications</em> (2nd ed., pp. 239-255). Wiley.</p>
<p>Bivand, R. S., Pebesma, E., &amp; Gómez-Rubio, V. (2013). <em>Applied Spatial Data Analysis with R</em> (2nd ed.). Springer. <a href="https://doi.org/10.1007/978-1-4614-7618-4" class="external-link">doi:10.1007/978-1-4614-7618-4</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse.grid</span>, package <span class="op">=</span> <span class="st">"spEnviroDistr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/is.projected.html" class="external-link">proj4string</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:28992"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>GDAL Message 1: +init=epsg:XXXX syntax is deprecated. It might return a CRS with a non-EPSG compliant axis order.</span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/gridded-methods.html" class="external-link">gridded</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse</span>, package <span class="op">=</span> <span class="st">"spEnviroDistr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/is.projected.html" class="external-link">proj4string</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:28992"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="createCluster.html">createCluster</a></span><span class="op">(</span>free <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RESULT</span> <span class="op">&lt;-</span> <span class="fu">applyGWR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">copper</span><span class="op">)</span> <span class="op">~</span> <span class="va">alt</span> <span class="op">+</span> <span class="va">dist</span>, <span class="va">meuse</span>, longlat <span class="op">=</span> <span class="cn">FALSE</span>, cl <span class="op">=</span> <span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">RESULT</span><span class="op">$</span><span class="va">output</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gwr(formula = formula, data = data, bandwidth = bwG, adapt = adG, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     hatmatrix = TRUE, longlat = longlat, cl = cl, predictions = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel function: gwr.Gauss </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adaptive quantile: 0.01146238 (about 1 of 155 data points)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of GWR coefficient estimates at data points:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Min.     1st Qu.      Median     3rd Qu.        Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.Intercept. -17.0918413   3.7531281   9.3204449  13.0599683  40.5131677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alt           -0.9623308  -0.2499946  -0.1443481   0.0032744   0.5419798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dist          -9.2546319  -3.8881674  -1.9964676  -0.7525851   3.9001866</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Global</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X.Intercept.  6.7962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alt          -0.0786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dist         -1.5609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of data points: 155 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective number of parameters (residual: 2traceS - traceS'S): 85.62554 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective degrees of freedom (residual: 2traceS - traceS'S): 69.37446 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sigma (residual: 2traceS - traceS'S): 0.261182 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective number of parameters (model: traceS): 66.28962 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Effective degrees of freedom (model: traceS): 88.71038 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sigma (model: traceS): 0.2309702 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sigma (ML): 0.1747339 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 139.6473 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC (GWR p. 96, eq. 4.22): -34.63161 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual sum of squares: 4.732451 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quasi-global R2: 0.8810787 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RESULT</span> <span class="op">&lt;-</span> <span class="fu">applyGWR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">copper</span><span class="op">)</span> <span class="op">~</span> <span class="va">alt</span> <span class="op">+</span> <span class="va">dist</span> <span class="op">+</span> <span class="va">elev</span>, <span class="va">meuse</span>, longlat <span class="op">=</span> <span class="cn">FALSE</span>, cl <span class="op">=</span> <span class="va">cl</span>, fit.points <span class="op">=</span> <span class="va">meuse.grid</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Guillermo Fuentes-Jaque, Luis Morales-Salinas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

